\clearpage
<!--
to do onboarding sa4ss - move this to sa4ss.sty so everyone's figures hold their order
https://stackoverflow.com/questions/29696172/how-to-hold-figure-position-with-figure-caption-in-pdf-output-of-knitr
-->
\floatplacement{table}{H}
# Tables

```{r table-catch, results = "asis"}
sa4ss::read_child(string_switchletter(
  file.path("..", "tables", "table-catchbystate-s-.tex"),
  params$area
))
```

```{r table-management-refpoints, results = "asis"}
management_oflabcacl <- utils::read.csv(file.path("..", "tables", "management-oflabcacl.csv"))
management_oflabcacl %>%
  dplyr::filter(area == params$area) %>%
  dplyr::select(-area) %>%
  dplyr::left_join(
    x = .,
    y = model[["catch"]] %>%
      dplyr::group_by(Yr) %>%
      dplyr::summarize(Observed = sum(Obs, na.rm = TRUE), Expected = sum(kill_bio, na.rm = TRUE), .groups = "keep") %>%
      dplyr::ungroup(),
    by = c(Year = "Yr")
  ) %>%
  dplyr::mutate_at(2:NCOL(.), ~ sprintf("%.2f", .x)) %>%
  kableExtra::kbl(
    longtable = FALSE, booktabs = TRUE, format = "latex",
    caption = paste0(
      "Recent trends in observed landings and expected dead biomass (mt) relative to management guidelines (\\glsentrylong{ofl}, \\glsentryshort{ofl}; \\glsentrylong{abc}, \\glsentryshort{abc}; \\glsentrylong{acl}, \\glsentryshort{acl}). Expected dead biomass represents the total landings plus the model-estimated dead discard biomass.",
      " ", text_wcgop, " ",
      "Additionally, management in 2011 and 2012 was based on a break at 42\\textdegree00\\textquotesingle N versus all other years used \\CapeM."
    ),
    label = "management-refpoints"
  ) %>%
  kableExtra::add_header_above(c(" ", "Management" = 3, "Landings" = 2)) %>%
  kableExtra::kable_styling(latex_options = c("repeat_header"))
```

```{r, cpue-tables, results = "asis", eval = grepl("North", params$area)}
# Arrange figures in order of the time they were modified
tabledataframe <- utils::read.csv(file.path("..", "tables", "tables_cpue.csv"))
tablefiles <- file.path("..", "tables",
  gsub("\\.csv", ".tex", tabledataframe[["filename"]])
)
ignore <- mapply(sa4ss::read_child, tablefiles[grepl("comm", tablefiles)])
ignore <- mapply(sa4ss::read_child, dir_order("..", "tables", grep = "reccpuewa"))
ignore <- mapply(sa4ss::read_child, tablefiles[grepl("rec", tablefiles)])
```

```{r, fi-index-ormarres-tables, results = "asis", eval = grepl("North", params$area)}
xx <- dir(file.path("..", "tables"), pattern = "fi-index-ormarres", full.names= TRUE)
ignore <- mapply(sa4ss::read_child, xx[order(file.info(xx)$mtime)])
```

<!-- Sample size tables -->
```{r, comp-sample-size-tables, results = "asis"}

sa4ss::read_child(filein = file.path("..", "tables", paste0("length_samps_", params$area, ".tex")))

sa4ss::read_child(filein = file.path("..", "tables", paste0("age_samps_", params$area, ".tex")))
```

<!-- Sample size tables for commercial by state -->
```{r, comp-sample-size-tables-commbyState, results = "asis", eval = grepl("North", params$area)}

sa4ss::read_child(filein = file.path("..", "tables", paste0("length_samps_comm_byState_", params$area, ".tex")))

sa4ss::read_child(filein = file.path("..", "tables", paste0("age_samps_comm_byState_", params$area, ".tex")))
```


<!-- ====================================================================== -->
<!-- 30model tables -->
<!-- ====================================================================== -->
```{r tables-model, results = "asis"}
table_outputconfig(model)
```

\begin{landscape}
```{r tables-model-sens, results = "asis"}
table_sens(string_switchletter("../tables/sens_table_s_bio_rec.csv", params$area))
table_sens(string_switchletter("../tables/sens_table_s_index.csv", params$area))
```
\end{landscape}
